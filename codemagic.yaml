# Check out https://docs.codemagic.io/yaml/building-a-native-android-app/ for more information

workflows:
  android_qa:
    name: Sign release and Firebase
    environment:
      vars:
        CM_KEY_ALIAS_NAME: Encrypted(Z0FBQUFBQmZteUZpZUhXNkhFNU53cnRQRFFDVE9CS3JjeWMzaHJUdmxtbExfU05LT1VITno1XzktcXRIdjM5dVRWZ2VXcmFHbGs2dUx5M0VnOVEtZElmazQ5UmtYTkVabHc9PQ==)
        CM_KEY_ALIAS_PASSWORD: Encrypted(Z0FBQUFBQmZteUVuSHgzZWpYaFh1OE5fSlhnc05SM3VOcG5uRF9aQXFOSFk0RWNUaDRObk9jb1NvZTU4TzFhWHAzWkI4elFkYjFmTUVCLTNqcUF1Q3VqenpxbFVVS1RqNnc9PQ==)
        CM_KEYSTORE_PASSWORD: Encrypted(Z0FBQUFBQmZteUVuSHgzZWpYaFh1OE5fSlhnc05SM3VOcG5uRF9aQXFOSFk0RWNUaDRObk9jb1NvZTU4TzFhWHAzWkI4elFkYjFmTUVCLTNqcUF1Q3VqenpxbFVVS1RqNnc9PQ==)
        CM_KESTORE: Encrypted(Z0FBQUFBQmZteUQ3emR0R0dic0Q3TmVseGwyazZCNkVRSmhXckctRk5HOXd5aTFibUhRUW5sR21ZWTNtamF6Zl9tdmpOMVQtLU9tVGxxS0NONFdkRW1LZ2ttQnlHR29aQ1V1QXBGTW41Sm1HME1OVEZDSXdUb3F5em53VkFOUUlKVXl1WklheEdQUXNhZVFucG1XNVZQd1A1NmtIQS0wc0FOUjkwN0NURWZSb2lWNFdaVmpXZGllWGVVNm04cDhSbHVkTXFMZTBGczBZWTcyZVBkdWtBWnhMU190cExBZ3dJSVJHYTF4dUJNT3A3eHZXaVJYZ1FBc3FZY2tWeXNydW5keTRxQm1QYURSZzRpblE3QVlpU0hQVzhwb29pdFgyQnlzSHpnZjdWTjBtakg1cnkxRWNqaHdVajhTUlFGRURIbVNfVG1QWXBrZGl5djRwZkU3WTZONFVCMWxkdFR2TGJkMm1hZW5leEowby1Pb0trUlBSQlE3blRiaUlheHUxNndtNDQ0a1hrLWx5dXQ3bG9IT04yVzJieG1SSTBDeWN3M1QxM1BiaGdqSXlWQXNlcnpkOHJGQTlWSkFDTVRYX3pxc2VFU1B6MXZMQ0gtWmFPc1BGZ2pEUUpOZmtacWVGbkhYenlfcmJtemV5em9xc0RKUmtLaEpaNlFFLXNLQ0M4aWVJZGE2SEk0NmF2d0wtT29RQy1URjZyQU0tYTNqU0FlNWhFUlBISWs5bjhIQU9NeGZFdDg0bzNvVERlX1pMU2J6Q3BYYVBaZkVpNGRJeTBsWkFzT1lVTS1zSkI5R0Y1X1lNWlQ2Y1ZYWlhibzdmYzNuckJXRjh6TmUzVVJWbFNmbm1Cd0xGZGZoNWpWQWlIb2RTNmdhY1pwWFg0cHp5STNVaGQ5bGhBZ1ByX2xsUFFXbFVpeGpPbkpmYmNmci1FSEVtd3NJSE8tUEZFYU0zcjQycGlidGJ0bzJWdC1NTThodkx3VzFxU1UxSE0yQ2Nwb0c5NmdLamlNUVVBNmF5Y1VWSGNESmtQVjVlNGV2QXZETUlSX0k5ODh3ejF3VW1faTR0NFBpSTBWenFkUmJtX0JIbTZZUWZKU3hTTVplWWlhZjltdzE1bU9ZNHh1X1kydzU4Zy1LZm4wQ2wwb3JqaDgwblh3TGdFRUdXdWhCMWNERHdOdWlNZlVoellLZkRJTjhGZXlWM2R0SUE0NXhWLXdCemdiQ0drYUNaaTlKcGEwX1BtU1N3NEpDYXVFMi0xNDlHQUN4dkx5U3JtNnVBT243OEZZY0dzWEpFR1NrWkR1TUllUGdSb05fYVNReHZ0N3pYR0JDUXJ1V1p4cVVxMGFTQ2lXRTB4THk3d1FNWUl0allEX2JtQ21WZjdZQkc4TTlWZnBreEY0M1N6YlhjZVRXcjBnVjQ1OFBleDRxUWFpQ2JZeWhQbkt1d2pFOHBqM2pfdTd0WEJ3T0hCaHVQX1o3YnQ0UmdrMU5MbnVrLTRjWGdkdVJzSWFDTkVRRjZGVjUxU08xYmtrQ3kzQjMzYXBSWDZEZkYyVk1WbkhfZ1k0OVJoUWluNW04NU02eFNhdkl5Zy1Dbl8tS1FpNGVweU0wTld5YWVrRk00SlRXZ2pMei1TRnlUYTNHWFFZaVpORDhKTVdSa0Qtdmg5d2Z6R3dWY2p2aXVRa1hwallLaG81dnBQcWlVOHRsNG9pUTVIemdoaDFhcTRiSUxoV3NRNEJ0VG9HemFZcDVtaERiR3JfazdEczI5dDdGTzdXR0hmaVlsSzlPb2NteHNpRU5DS0x0TjBwQTN4ZjFjNkVDUkE3MUgwR0xwekVYVndQODhoa1V2djVQVzFTQzYwRUlGWTgxR09kUFNoZkpHOWN0RDFrZnRPTDBPWWtNc0NsVmNJempmTnRRdEYxSlBEcWNIdnBXNFJIZVd6YTl6UGFZbzU3TWNIa05lb2sxRmgzV3QzMTctcWtNYVBLRTJxRWZNaV9RSnRlZm1fWmVNRHdWN2V3cWN4SGFSUHY4a2haVzhjRWw4UVZnZHJrZS1ybVdLN25rQU9Gdm8xeWxrV3hUOTdHUlRCVDZ6blM2SjQ3NU5Pa01peXJGSUpSTzEweDZqMDd3VmU3ZFRlc1BseUpWT1ZaNTZweG1OYmhmRDJDRkZVSFlSM3JUdHoxWWQ3dnI1OERrRnlYa0ZRUFVhZ1dIbHU2VGJUWjdodHh0b3ItNFE1TXdOc0dxUFEzbE9LRTJ6ZHo0S3FlYk4wUFlJRlhGbzZBN21RbEtiZGtmNXN1OXFxVko2ZS1KT1FiY3pEczVaTlRUOTlhOEJwYUE5cU5wOTNPcU9uamRNTUpuUWk5NXlzcVAtSkZocU1QOThCN3JJUXgtbXBfNWpkVmQwNGtXUWZvQ3h6QW1PeFp3eDhGdEV2VkdoU0FBV2ZCZmFQUkdpaU1WRUlBLUNWYXZPLVBRNTZqU0dmSFVrQUZqZk1OczVtWmZUQ29VZmhTZ09CUW43N3lUZXVyOUJtbzdWUmVzS2V1ZDd6MHhpMV8xTUtfd19XdFBjU2d5ZHlteVBpVlpvejNaU01ISE80SmtrOUNHVlVXUkNhNnRnZE1JeUo2b3pTb0dKM1Z3dVJ1bTZCWEJkMmhYZXAzMUxaVVRoX01mZjhGdEVpVDYxemNxQWEtQklHTEZ6azBrSnVtYy1rWDNVNk43UE8xcUo4bUQ2cHFrdlZWODNtblN2dTN4UXJJY0NwbmNSdDVKaXh2OTcyQkpuRHZZS3hDeWppYmhXczVQbUdrc2hLVWJyYkxjaGpmdElldGl6Z1I5OTVmbGc2RDVubDJtdVBaQjJNT0JKUkR3c2QxR1ZldThhZWM5U3Rnc3RnRU1HdjJqNlRFWkY5WElITUtBX1NJSUtEVDhJTVpzRS1rajdtMWpHX2VZbHJGTmNaVGF2cDFKcUlkOEthZ2tBWHEyNVVjZE53eXlQbzlQSXZLWXVOZGotLXNoalYtam9HVTNJT2lud3Bvc053S1hHS0sxSk85dU42Wk9YUnlUclpZOXNrR2d5RWtKTjh1TGFVekd2QjJlRWMzRGtsVXMyMnVMN0ZSb3dVNWhMM00xSUpNazZDbFA5VWszRlExUV85U2JNZ042QnUxMnc2a1VvNEFxNUo3dnh2dEtJenVHTEhQbEZnSUVBajhuZDRzbFM5ZmVfUHczYzRRTWl0S2RtSE9yU0FrNmYtb09hMTU1UVcxeE4wUElILVFEY1hqOWlESVYwcEp6dDJGRURrQmFiYTY2ZXhXU3BKVEczQkJSdnplVy14SHpHeWlPMUdqV2dIVm1HR3I5cFRzTmwzRDFGTkFUTVg1bUNudVJsVHNVdWVra0FtN2xYS2Z0UFJHZ1ZyeDlDSGk4RnlzX2w1YlNfYldoNVpDNTNSTFA5dTJfRkpqWVAxSU1ZRm8wQ0pXSlVCc1NXVE9McllaYVNUcDlIV3pFZnVyVnFvLTJNYm9iWVVpRjFkQnpiWXVFaF9pUUVzeVhjVHZPSnNISm9SLS1WNjBtcWw0X1paQzUxNVEtMHVfcEk2MVU2bjJGUXlocHFOX1JrZ042a2tCQm9tRnZ6TENvWXdSdGdoZGd4QUozVFVXcmxTUVNhMlJwQU9FcU1QNDRNRXBuSFV6NGVBTHVRY01fV3hMcmExRWVfXzdDdEFNSlF6U0xEUlNqTGNoRGdFelhPN1U4S3c1SEZwTnVtS183X2l2TTJxZnJUd1Z1QUdKTmFvTHkyaTk0MGUtcjRqRFRJQjNOQXhmelZTWUgzSGdTcTJ3Mjh1Y0pIaDBoN1JkX0tFTFJKTlVvdWFDenBnMk11Z3RLV2txNmdCVlYySk5SYlVTLXJOdHhMWlRUTnphQWluYkFyZzFUb2tDZ1FDbmhYX19vcUp2Q280T29Zdi1aS3JrNUZrSVV3UHdLSVdmbF9LbV9tZTdpM1hOeWhQaTFUVnNsdlJZX21CcWRWYVlwbGJEekJxT0F5a25LMDhoaFk5bVBzOHUwT3IzUzhvQTZyUE5RVWRDT3FlR2hScm81SUdKWTg4WnJ6OXdaUERPa2dLUHUzMlhoZjlZS0RoRzZkTjBHRlZQYlZjTkMtREIxUEdDQ3RUckNQSEVCRnJtYWtQQXJvbUVuU3VyZ291dDJxZndsRVBUNllYcmRKMFNfQnZoYVFLUDkxM3oybVAzMVVzTmVrWThScVp1b1dId3ZDd3Vmczk1TG05Z1RGY2RmWkcyeEQ4b0tJN3gtR1BneHRBM0N4OHZPcFkwWnR5REtFVGwxRzFvZHZrUnNldEo5ak81Tjc4NTZ0NTczNjRGb3JNUEtuZjR1OWJIUkM2THgtWVkwR3MtTjZrZC03dnVndHBkbWhYTGxlZDhmSTNyNnExWjZoSTdiVzBpU1VjaXlrRGtCQ0Q4SjdodmRKcjY3bTBOckY5Qzg4cnQ4bnJoZUplUnpXMkI5bnNNQno1TV9ENjc3Vk1QVk1CNzBDSFlCSzRwcnN2eWhjblJib1Z3REhTNWRYTFE3NmtTVHFDaWQ4ejNaeXdkUm5vZ3NXTVlYVlE3SzRzVVNsc1dPY0t0cFBkbUhHYWFLZXlqaEY4TjN3Nk0yTV9HWTlKSHVpNUNNQ3NlSF9fX0s0SlVlNnVIVGJhY2MtV3hmTEllckUybUszRW95WmZxZUtZR0tYWGxOcXVlNENRVFFwUUJISDdzaUQ1azNGZWRqS056Tnp0OEFkTU00MURzS3JFLVc4X2tzVF9VekNtTHlrVEx1dkJlejI1N1hpSC1ncmltelIzbXFaV2VCT3NHa0wySHhjVkdsRUV1aDlrN3FVUTBnVUdOVkFHOFZsbkYxYmctZlpYNHNVLWpWWUdOVGJRODNYRHJUdHlUN0VUU0hTTmlXNm1qbWItTVZYZ2ZncEliOU1aWnc4bUMxSXptc0pEbWtLd2RTX0RVYlNhZThvTHQwdWk2QmZWVURld3ZRUXNjM0h4djUwdEFzM3oyZnhDbmR0Tnd4MU94dWNZMHBOcjhwRjRPMEtRZEo1dlhlMmZQWmtOT0ljR3hQX01mMm14MkM5ZDVab2taRjBZeFJ0TWQ4SWpOZEVWTk1odVhmUzhiS25iRHdPbklESEVJQlFyWWJhZU0yN05BVFRjZVF1Q3lQYUlrUUpFdnVaZkpQOXMxM1diQXFBRnV3YWNmSGdlLXFfb24zLWdKRk50WWplbmJXWC1jVHBRV1N1c0twYlg3dl90bjVfRGNzcmdPYlFJWVlIWVphVmhURkRoc0lYU09GN1dCXzA4WF9iR0lneEtWU0p2U285V21QSnZfaHVmVjBOd3ZTSWl6UWRiVEo2dEdTTl8tMG56bDVCV01PcEsySGlZY0RnTEpRaWRqX3l5QnFXRU9ObnUtRTlmRkxDUFRIRmVGMUprc1BOU2djZXJPcDhCZW1zcDRWYUFjM1ZteEhZTjhtck9tZVJZQkhkYzlidXJ5dlVmazNjNDA5SklDRFpCQnZMelBQQWlNRkJER0x1a2dZa25KQzdQazRDSHNGdlpENWNxbWJqNVRYSjhCTU1FZ0lXTzBISnhqZVlnTHpkSE1EaEsxNTVsT0RLMGRDSTZUeFJKYmNudEJ0Rm53LXhfaDF1OXhBNFpGb0ZkX1ZZVDZZTTNYQ09VX3MwREFBUzJqb0RSQ0lZVXo2ZTVWS0R6blFpTVh2ZFNjeE51Z2dnQ1dqX3Q2S0xmX2dYNjUyYWxJRFlfNnNBaUZsc0lXRTJYMzRBbGpRdzVudmxEZEdmUDUtWDBqUGtJYTE5dm92aHBfY2lsQWZIVGdWNDJGWXJLWjBoUGNMNXRvR0hmQktTTnhGWE1uQllrejY0VWx3RHhhSlFJa0lEc1N0Y0FiNUxZNFVYZFhVTmNqNUZyUmtZUHNVVlJCTGx3REhSZkdpYzNxQXUwVWJ2NnVkQUZ5aE8tVzdWdjZQTTByNzc4Mjh0em43djc1SlFydzhlSEZVUEVwc2JJeEdqOWRjQ2htdlphSDlhZndhRnZWakh2YWtPT0tyRXhuZ0dtaGpIMUN4VWJ0UHlDVjdlUFlZR3MtR3BPQXlpam5kQmJGRVpMT29mem9wQzNIZ3NvNnk2RkVab3VMRU8yY1RZc2E3YU1ZbWFoSU5qS1BoZmJtZ21iWmFiS2sxMm1BODR5dEVo)
        FIREBASE_TOKEN: Encrypted(Z0FBQUFBQmZteFljNjVNRkVvcEVjWXo5OGVvNEV2SzZjVVZmeGduSGdPa3VTZXBXclFvZkpFOU1ZMlZyVjlLS0xFTm1aSEpLVGVnbDJmM0dqYTAzamNKMHI1c2Z2Um1TYVpyRTVCZ1NEVHVEWElNVUZBalViQnNZb1pNWHlWWW55TWxPMjZHdzhoUDdheGZRNV92S0M1NFRtclM2UDFLRUxVbUUzc0ZzaW9WbllWYXVnZ05GMnp6WFBoajZxRGwwSXlySEwzd1dkU05BMG5XZ21RcHZwcXRDdUVXY3ZVaHZHZz09)
        FIREBASE_JSON: Encrypted(Z0FBQUFBQmZteFFaT0NiYXVhcmttYVB1Snh2LVUwci1sNE1aNkwtazdTc0dOQlJieWYxSlZ2bGpoZ2Z5OTBfNHJWcFd5QmswNldqR24yUzhYQVdfVEN0LVo5R1QzZmJtRzdDQWVBNnNpRVJkWE9QcnBVNDZaa3RzZXlrbDZRWDROZHpwMGFodUJYaWZucHJQX29tZzk3bFNqTTBLeEROdFdqN3ptXzZLWHY1WndRYkdSamloOGhNSFZMUENreHFBdndBNzBUZjRGMERDWXJFNmNhSHRHZ3pZYks3dXZjaTF4YXlldnVaZEYweVYxUTdpQlk1Zi10Wkt5c2xuVGtJQzhrY3htTmhyVFJOU0lPcXJoZXVuUEVJOVdaUE1TdDhoa3pCTlExN2M0a3ZXQTFuS2NOa0E3ZTU1RkFaVm91UVlHbGdtdjZ5d2FZd0ltdkhkUm9ZdzhycTlUUkEzZWdKLWZJakRMR2VVLXpkUFdLUXdGM0FxMEY4RzhjczE2SXk3MXFEWXNMYnJFRHpLVEEwZ0ZPa29MUmhVLU42bjF0ekd0ZXNhbHBzSm44TzN4dWtsbUs4SjAxU2kyeXdEdlNvbElWWThaN3h4dF9lVVhCM0hiWDlJNUdwVHNidDZDOHREenhDMEM1SkhudGFiWlRpMXY3NkJrQzctOWNscUxFck82ZUNjZHFxaUFMVjZnUWpiNFZiMERQcE5ycnR6UnN2WkU5WkYxSUgxRzlGZklYNVlnU2xuVEtxdnJPWU1GMEFjWWVPbmQ4X3hIc1VKYjQzSzZjZmhXZGoyUVgzQk45NDRxQXNRUXJfN080TzBDNFVsc0IzZ05ESjRKS0lmQUFuZkw1dmxxYUp2WkFoVF9NZ1B3eU1sODFPdVBNcHJ5UmJfOFFya215cFVic2I2Q0JoZVU1Q3lZM29ubWZFZkhIVkRIdHMwQ2JhSHphWllPckdRM2tFZG54Vk5sQ2FGeUsyV3d3UkRZc20zdEpxLS1tLXZPem1tS0tvN1M2aGJuX25Ea29xaFF3V1FkemVzQUIzN0tHd0ZJYTBGeFUzTU56VEc0ZTYwczJrelBNamJ4NTFjb2IzQk5MNndaUXFYbk1Fc050SjNicDc3Uklza2V6anh0Z3FLSXc4czdpOXdCU01Nd190S1p0c0VOR1lzdXM0VXljMi1RampDeF9falBwTnV0VUhwby1ZVTNhUG9wRmN2dkVKR1l5RUxrejN3RHBzZUFMelZlTm1jODlhcFFnT0FrcG1VVW1fS2xWU1JRYnFHMHlXM0hfQzA0ZnFfZEQtS1VLREtiXzZGMTlvVW9VMkIzWFFjR09VeGpZd3phNExJN3h6ektUamRYVmFrbllKVjlZLURlR1k0bE5fdXhOcFJtVTZzY3hyb212OFFkVlRaUFVKZXp0ZjEyNXFMNGVGeW55cGM2enZzU3JHbjJRdXRVeWU5Q3hCSEZmSDNCa2YtTWc1cFJIcUotZ29xWklBQ28xdGFadW9hWG9jdW9EbzEyRlBJajEzT3JiWkNSOGJOcnBvaURXU2VucGF6WjQ2V0UzTmQyZmxmbzJyNTBla3pSalVBUk56T1M1YTVVcU9YZ3hDZlBhNWJta3d1LTBkanBSMF9Ea0hCT25MV3N1OURFSV9Jb2pZUC1kU1dacGNLSXlzM2RJU29lZEVfdG9zbkRZR3ZEWVNxQXd5U2JJTjVXTGdfNVU4TnlhNlRXZHRiLUNwN09tR3hrZGdqVTFjaFZ5clFLMTZLUFdzVlo0d1JnQ21wdHhmWFVpWWF3Tldpei0xWWZ4cmdwcHBLQmVZQW9MQjA0a2dieEhSb3E0dVdOTE8yMGdqWW1vczhfZlFxVXR3ZXUxcVVQYklHQ2E3VVBxZmxHN2ZVRHlLZHE2V1YwNFMtYjhpdGZaMnFZY3Y4OVNySXdzbDluWHBPX0o1Z3NsTEhEb0xTdDQ3VVc2MEJ3UEFjQ0dZdWNnSFk1UUhQQTNXYW44V2RFX19zdkp1dm9peFFfOUZNc1R1aVpGOGFBaFd0X2dXb0xLeFU4Q1QxdGh0M0pib3lES0tiVG9FN3AwTXZIOGFyVmt2SXoyYkpybWNONTFXRm5aSXdNbFFkVzk1QlNKLVRDM2M2ZjFtWUczQVFKaVV1U09nVnU2Mm5SNnh6MmJRRzNlMC13UWJRNW5CMk1hakdRUThRQWVPOEtldmtPTy1aa3ExSHlZQ2hVaEZOV09VejRkV2xuTDM3RkVaSUJLdjRLaHN3eFhvQmhVcFNpLTZRQXlzdFZwc21IY1JWUXpqTmZweDQyTDZ0OXU4ODBkdy1LSTRueHpvd2JCNmdyNC1remxiZ0p4aHpTYWFOWUdZNHdnby1Bb3ZXN0JYdmpuOFI0NTVOMFEzeDlYMzJ2b1pZM0s1Sjd2VUdHd2xwekpZWDZHbDhVQno2TkdUVGNKdW5xSTVYM2p0NlBwNjhzS3Bzbjc5WGtNNkFiTENDMFMzckhJZGplMlJmRXhYdVA3eFlYLUw5ZlBDRmRLV0M3VzBjb2VtUXFTVXRVNG1yQ2VmaXdVLXNnc1dFTlNTNlR6MnJoUzhDQ3pXMTh0WnY3bUxYZGNvdWtkZ3BYLWVCVGZRRFQzc0ZsNUxoRl9hSG9wRT0=)
    cache:
      cache_paths:
        - $HOME/.gradle/caches
    scripts:
      - name: Set up key.properties
        script: |
          echo $CM_KEYSTORE | base64 --decode > /tmp/keystore.keystore
          cat >> "$FCI_BUILD_DIR/project_directory/android/key.properties" <<EOF
          storePassword=$CM_KEYSTORE_PASSWORD
          keyPassword=$CM_KEY_ALIAS_PASSWORD
          keyAlias=$CM_KEY_ALIAS_USERNAME
          storeFile=/tmp/keystore.keystore
          EOF
      - echo $FIREBASE_JSON | base64 --decode > $FCI_BUILD_DIR/app/google-services.json
      - ./gradlew assembleRelease
      - firebase appdistribution:distribute $FCI_BUILD_OUTPUT_DIR/app-release-universal.apk --app 1:99999999999:android:8888888888888888888888 --groups "android-testers" --token "$FIREBASE_TOKEN"
    artifacts:
      - app/build/outputs/**/*.apk
